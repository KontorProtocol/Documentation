<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2400 1600" width="2400" height="1600">
  <!-- Definitions -->
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; }
      .subtitle { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; }
      .label { font-family: Arial, sans-serif; font-size: 14px; }
      .small-label { font-family: Arial, sans-serif; font-size: 12px; }
      .tx-box { fill: none; stroke: #000; stroke-width: 2; }
      .dashed-box { fill: none; stroke: #000; stroke-width: 2; stroke-dasharray: 5,5; }
      .script-box { fill: #c1e1c1; stroke: #000; stroke-width: 2; }
      .output-box { fill: #aec6cf; stroke: #000; stroke-width: 2; }
      .opreturn-box { fill: #e6e6e6; stroke: #000; stroke-width: 2; }
      .change-box { fill: none; stroke: #000; stroke-width: 2; }
      .arrow { fill: none; stroke: #000; stroke-width: 3; }
      .arrow-head { fill: #000; }
    </style>
  </defs>

  <!-- Main Title -->
  <text x="1200" y="40" text-anchor="middle" class="title">Ordinal Inscription + Swap + Storage Agreement</text>

  <!-- =================== ORDINAL INSCRIPTION =================== -->
  
  <!-- Commit Transaction -->
  <text x="50" y="100" class="subtitle">Ordinal Commit Transaction</text>
  <rect x="50" y="120" width="500" height="240" class="dashed-box"/>
  
  <text x="70" y="150" class="label" font-weight="bold">Inputs</text>
  <text x="300" y="150" class="label" font-weight="bold">Outputs</text>
  
  <rect x="70" y="170" width="180" height="60" class="change-box"/>
  <text x="160" y="205" text-anchor="middle" class="label">Funding Input</text>
  
  <rect x="310" y="170" width="180" height="60" class="output-box"/>
  <text x="400" y="205" text-anchor="middle" class="label">ScriptPubKey</text>
  
  <rect x="310" y="250" width="180" height="60" class="change-box"/>
  <text x="400" y="285" text-anchor="middle" class="label">Change</text>
  
  <line x1="250" y1="200" x2="310" y2="200" class="arrow"/>
  <polygon points="310,200 303,196 303,204" class="arrow-head"/>

  <!-- Reveal Transaction -->
  <text x="650" y="100" class="subtitle">Ordinal Reveal Transaction</text>
  <rect x="650" y="120" width="500" height="340" class="dashed-box"/>
  
  <text x="670" y="150" class="label" font-weight="bold">Inputs</text>
  <text x="900" y="150" class="label" font-weight="bold">Outputs</text>
  
  <rect x="670" y="170" width="200" height="130" class="script-box"/>
  <text x="770" y="195" text-anchor="middle" class="small-label">Script:</text>
  <text x="770" y="215" text-anchor="middle" class="small-label">x-only public key</text>
  <text x="770" y="235" text-anchor="middle" class="small-label" font-weight="bold">ORDINAL INSCRIPTION</text>
  <text x="770" y="255" text-anchor="middle" class="small-label">p: "kor"</text>
  <text x="770" y="275" text-anchor="middle" class="small-label">content_hash</text>
  <text x="770" y="290" text-anchor="middle" class="small-label">content_type</text>
  
  <rect x="920" y="170" width="200" height="80" class="output-box"/>
  <text x="1020" y="200" text-anchor="middle" class="small-label">ScriptPubKey</text>
  <text x="1020" y="220" text-anchor="middle" class="small-label" font-weight="bold">Script Path Spend</text>
  <text x="1020" y="235" text-anchor="middle" class="small-label">(Ordinal UTXO)</text>
  
  <rect x="920" y="270" width="200" height="60" class="change-box"/>
  <text x="1020" y="295" text-anchor="middle" class="small-label">Change</text>
  <text x="1020" y="315" text-anchor="middle" class="small-label" font-weight="bold">Key Path Spend</text>
  
  <line x1="550" y1="200" x2="650" y2="235" class="arrow"/>
  <polygon points="650,235 643,233 645,240" class="arrow-head"/>
  <text x="580" y="210" class="small-label">Script Path Spend</text>

  <!-- =================== SWAP =================== -->
  
  <!-- Commit Transaction -->
  <text x="50" y="540" class="subtitle">Swap Commit Transaction</text>
  <rect x="50" y="560" width="500" height="240" class="dashed-box"/>
  
  <text x="70" y="590" class="label" font-weight="bold">Inputs</text>
  <text x="300" y="590" class="label" font-weight="bold">Outputs</text>
  
  <rect x="70" y="610" width="180" height="60" class="change-box"/>
  <text x="160" y="645" text-anchor="middle" class="label">Funding Input</text>
  
  <rect x="310" y="610" width="180" height="60" class="output-box"/>
  <text x="400" y="645" text-anchor="middle" class="label">ScriptPubKey</text>
  
  <rect x="310" y="690" width="180" height="60" class="change-box"/>
  <text x="400" y="725" text-anchor="middle" class="label">Change</text>
  
  <line x1="250" y1="640" x2="310" y2="640" class="arrow"/>
  <polygon points="310,640 303,636 303,644" class="arrow-head"/>

  <!-- Reveal Transaction -->
  <text x="650" y="540" class="subtitle">Swap Reveal Transaction</text>
  <rect x="650" y="560" width="500" height="380" class="dashed-box"/>
  
  <text x="670" y="590" class="label" font-weight="bold">Inputs</text>
  <text x="900" y="590" class="label" font-weight="bold">Outputs</text>
  
  <rect x="670" y="610" width="200" height="80" class="script-box"/>
  <text x="770" y="635" text-anchor="middle" class="small-label">Script:</text>
  <text x="770" y="655" text-anchor="middle" class="small-label">x-only public key</text>
  <text x="770" y="675" text-anchor="middle" class="small-label" font-weight="bold">SWAP</text>
  
  <rect x="670" y="710" width="200" height="60" class="change-box"/>
  <text x="770" y="745" text-anchor="middle" class="label">Funding Input</text>
  
  <rect x="920" y="610" width="200" height="60" class="change-box"/>
  <text x="1020" y="645" text-anchor="middle" class="label">Price Output</text>
  
  <rect x="920" y="690" width="200" height="60" class="opreturn-box"/>
  <text x="1020" y="715" text-anchor="middle" class="small-label">OP_RETURN</text>
  <text x="1020" y="735" text-anchor="middle" class="small-label">x-only public key</text>
  
  <rect x="920" y="770" width="200" height="80" class="output-box"/>
  <text x="1020" y="800" text-anchor="middle" class="small-label">Change</text>
  <text x="1020" y="820" text-anchor="middle" class="small-label" font-weight="bold">(KOR tokens)</text>
  <text x="1020" y="835" text-anchor="middle" class="small-label">to Buyer</text>
  
  <line x1="550" y1="640" x2="650" y2="650" class="arrow"/>
  <polygon points="650,650 643,648 645,655" class="arrow-head"/>
  <text x="580" y="640" class="small-label">Script Path Spend</text>
  
  <!-- Side labels -->
  <path d="M 1170 610 L 1190 610 L 1190 670 L 1170 670" stroke="#000" stroke-width="2" fill="none"/>
  <text x="1200" y="645" class="label">Seller PSBT</text>
  
  <path d="M 1170 690 L 1190 690 L 1190 850 L 1170 850" stroke="#000" stroke-width="2" fill="none"/>
  <text x="1200" y="760" class="label">Buyer Inputs</text>
  <text x="1200" y="780" class="label">and Outputs</text>

  <!-- =================== STORAGE AGREEMENT =================== -->
  
  <!-- Commit Transaction -->
  <text x="50" y="1020" class="subtitle">Storage Commit Transaction</text>
  <rect x="50" y="1040" width="500" height="280" class="dashed-box"/>
  
  <text x="70" y="1070" class="label" font-weight="bold">Inputs</text>
  <text x="300" y="1070" class="label" font-weight="bold">Outputs</text>
  
  <rect x="70" y="1090" width="180" height="60" class="output-box"/>
  <text x="160" y="1115" text-anchor="middle" class="small-label">KOR UTXO</text>
  <text x="160" y="1133" text-anchor="middle" class="small-label">(from Swap)</text>
  
  <rect x="70" y="1170" width="180" height="60" class="change-box"/>
  <text x="160" y="1205" text-anchor="middle" class="label">Funding Input</text>
  
  <rect x="310" y="1130" width="180" height="60" class="output-box"/>
  <text x="400" y="1165" text-anchor="middle" class="label">ScriptPubKey</text>
  
  <rect x="310" y="1210" width="180" height="60" class="change-box"/>
  <text x="400" y="1245" text-anchor="middle" class="label">Change</text>
  
  <line x1="250" y1="1120" x2="310" y2="1160" class="arrow"/>
  <polygon points="310,160 303,156 303,164" class="arrow-head"/>
  
  <line x1="250" y1="1200" x2="310" y2="1160" class="arrow"/>
  <polygon points="310,160 303,156 303,164" class="arrow-head"/>

  <!-- Reveal Transaction -->
  <text x="650" y="1020" class="subtitle">Storage Reveal Transaction</text>
  <rect x="650" y="1040" width="500" height="480" class="dashed-box"/>
  
  <text x="670" y="1070" class="label" font-weight="bold">Inputs</text>
  <text x="900" y="1070" class="label" font-weight="bold">Outputs</text>
  
  <rect x="670" y="1090" width="200" height="100" class="script-box"/>
  <text x="770" y="1115" text-anchor="middle" class="small-label">Script:</text>
  <text x="770" y="1135" text-anchor="middle" class="small-label">x-only public key</text>
  <text x="770" y="1155" text-anchor="middle" class="small-label" font-weight="bold">STORAGE</text>
  <text x="770" y="1175" text-anchor="middle" class="small-label" font-weight="bold">AGREEMENT</text>
  
  <rect x="670" y="1210" width="200" height="60" class="change-box"/>
  <text x="770" y="1245" text-anchor="middle" class="label">Funding Input</text>
  
  <rect x="920" y="1090" width="200" height="60" class="change-box"/>
  <text x="1020" y="1115" text-anchor="middle" class="small-label">Storage Node 1</text>
  <text x="1020" y="1133" text-anchor="middle" class="small-label">KOR Payment</text>
  
  <rect x="920" y="1170" width="200" height="60" class="change-box"/>
  <text x="1020" y="1195" text-anchor="middle" class="small-label">Storage Node 2</text>
  <text x="1020" y="1213" text-anchor="middle" class="small-label">KOR Payment</text>
  
  <rect x="920" y="1250" width="200" height="60" class="change-box"/>
  <text x="1020" y="1275" text-anchor="middle" class="small-label">Storage Node N</text>
  <text x="1020" y="1293" text-anchor="middle" class="small-label">KOR Payment</text>
  
  <rect x="920" y="1330" width="200" height="80" class="opreturn-box"/>
  <text x="1020" y="1360" text-anchor="middle" class="small-label">OP_RETURN</text>
  <text x="1020" y="1380" text-anchor="middle" class="small-label">Agreement Data</text>
  <text x="1020" y="1395" text-anchor="middle" class="small-label">Ordinal Reference</text>
  
  <rect x="920" y="1430" width="200" height="60" class="change-box"/>
  <text x="1020" y="1465" text-anchor="middle" class="label">Change</text>
  
  <line x1="550" y1="1160" x2="650" y2="1140" class="arrow"/>
  <polygon points="650,1140 643,1138 645,1145" class="arrow-head"/>
  <text x="580" y="1145" class="small-label">Script Path Spend</text>

  <!-- Connection arrows between transactions -->
  
  <!-- Ordinal to Storage (dashed reference line) -->
  <line x1="1020" y1="240" x2="1020" y2="500" stroke="#999" stroke-width="2" stroke-dasharray="8,4"/>
  <line x1="1020" y1="500" x2="770" y2="1090" stroke="#999" stroke-width="2" stroke-dasharray="8,4"/>
  <polygon points="770,1090 775,1082 763,1082" fill="#999"/>
  <text x="1030" y="400" class="small-label" fill="#666">Referenced in</text>
  <text x="1030" y="420" class="small-label" fill="#666">Storage Agreement</text>
  
  <!-- Swap KOR to Storage -->
  <line x1="1020" y1="850" x2="1020" y2="960" stroke="#000" stroke-width="3" stroke-dasharray="8,4"/>
  <line x1="1020" y1="960" x2="160" y2="1090" stroke="#000" stroke-width="3" stroke-dasharray="8,4"/>
  <polygon points="160,1090 165,1082 153,1082" class="arrow-head"/>
  <text x="900" y="930" class="label">Funds Storage</text>

</svg>